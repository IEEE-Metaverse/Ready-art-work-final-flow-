<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UI/UX Competitive Analysis Results - Competitor Web UI UX</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Header with Steps -->
    <header class="wizard-header results-header">
        <div class="container">
            <div class="brand-section">
                <div class="brand-icon">3</div>
                <div class="brand-info">
                    <h1>Competitor Web UI UX</h1>
                    <p>Data-Driven Competitive Analysis</p>
                </div>
            </div>
            
            <div class="steps-navigation">
                <div class="step active">STEP 1</div>
                <div class="step active">STEP 2</div>
                <div class="step active">STEP 3</div>
                <div class="step current">STEP 4</div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <!-- Hero Section -->
            <section class="results-hero">
                <h2>UI/UX Competitive Analysis Results</h2>
                <p>Detailed comparison metrics to identify strengths, weaknesses, and optimization opportunities</p>
            </section>

            <!-- Single Unified Results Table -->
            <div class="unified-results-container">
                <div class="table-scroll-wrapper">
                    <table class="unified-results-table">
                        <thead>
                            <tr>
                                <th class="criteria-column">
                                    <div class="criteria-header">
                                        <span class="criteria-icon">üìä</span>
                                        <span>Criteria</span>
                                    </div>
                                </th>
                                {% for result in results %}
                                <th class="website-column">
                                    <div class="website-header">
                                        <div class="company-name">{{ get_company_name(result.url) }}</div>
                                        <div class="website-url">
                                            <a href="{{ result.url }}" target="_blank">{{ result.url }}</a>
                                        </div>
                                        <div class="status-badge status-{{ result.status }}">
                                            {{ 'SUCCESS' if result.status == 'success' else 'ERROR' }}
                                        </div>
                                    </div>
                                </th>
                                {% endfor %}
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Website URL Row -->
                            <tr class="data-row">
                                <td class="criteria-cell">Website URL</td>
                                {% for result in results %}
                                <td class="data-cell">
                                    <div class="url-display">{{ result.url }}</div>
                                </td>
                                {% endfor %}
                            </tr>

                            <!-- Overall Score Row -->
                            <tr class="data-row score-row">
                                <td class="criteria-cell">Overall UI/UX Score</td>
                                {% for result in results %}
                                <td class="data-cell">
                                    {% if result.status == 'success' %}
                                        <div class="score-value">{{ extract_overall_score(result.content) or 'N/A' }}</div>
                                    {% else %}
                                        <div class="error-indicator">Error</div>
                                    {% endif %}
                                </td>
                                {% endfor %}
                            </tr>

                            <!-- Website Overview Row -->
                            <tr class="data-row">
                                <td class="criteria-cell">Website Overview</td>
                                {% for result in results %}
                                <td class="data-cell">
                                    {% if result.status == 'success' %}
                                        <div class="description-text">{{ extract_website_description(result.content) }}</div>
                                    {% else %}
                                        <div class="error-description">{{ result.error or 'Analysis failed' }}</div>
                                    {% endif %}
                                </td>
                                {% endfor %}
                            </tr>

                            <!-- Section Header: User Experience Analysis -->
                            <tr class="section-row">
                                <td class="section-cell" colspan="{{ results|length + 1 }}">
                                    <div class="section-header">
                                        <span class="section-icon">üë§</span>
                                        <span>USER EXPERIENCE ANALYSIS</span>
                                    </div>
                                </td>
                            </tr>

                            <!-- Consumer Appeal Score -->
                            <tr class="data-row score-row">
                                <td class="criteria-cell">Consumer Appeal Score</td>
                                {% for result in results %}
                                <td class="data-cell">
                                    {% if result.status == 'success' %}
                                        <div class="score-value">{{ extract_audience_score(result.content) or 'N/A' }}</div>
                                        {% set desc = extract_audience_description(result.content) %}
                                        {% if desc %}
                                        <div class="score-description">{{ desc }}</div>
                                        {% endif %}
                                    {% else %}
                                        <div class="error-indicator">Error</div>
                                    {% endif %}
                                </td>
                                {% endfor %}
                            </tr>

                            <!-- Technical Implementation Score -->
                            <tr class="data-row score-row">
                                <td class="criteria-cell">Technical Implementation Score</td>
                                {% for result in results %}
                                <td class="data-cell">
                                    {% if result.status == 'success' %}
                                        <div class="score-value">{{ extract_developer_score(result.content) or 'N/A' }}</div>
                                        {% set desc = extract_developer_description(result.content) %}
                                        {% if desc %}
                                        <div class="score-description">{{ desc }}</div>
                                        {% endif %}
                                    {% else %}
                                        <div class="error-indicator">Error</div>
                                    {% endif %}
                                </td>
                                {% endfor %}
                            </tr>

                            <!-- Business Impact Score -->
                            <tr class="data-row score-row">
                                <td class="criteria-cell">Business Impact Score</td>
                                {% for result in results %}
                                <td class="data-cell">
                                    {% if result.status == 'success' %}
                                        <div class="score-value">{{ extract_investor_score(result.content) or 'N/A' }}</div>
                                        {% set desc = extract_investor_description(result.content) %}
                                        {% if desc %}
                                        <div class="score-description">{{ desc }}</div>
                                        {% endif %}
                                    {% else %}
                                        <div class="error-indicator">Error</div>
                                    {% endif %}
                                </td>
                                {% endfor %}
                            </tr>

                            <!-- Section Header: Design & Usability Metrics -->
                            <tr class="section-row">
                                <td class="section-cell" colspan="{{ results|length + 1 }}">
                                    <div class="section-header">
                                        <span class="section-icon">üé®</span>
                                        <span>DESIGN & USABILITY METRICS</span>
                                    </div>
                                </td>
                            </tr>

                            <!-- Content Clarity Score -->
                            <tr class="data-row score-row">
                                <td class="criteria-cell">Content Clarity Score</td>
                                {% for result in results %}
                                <td class="data-cell">
                                    {% if result.status == 'success' %}
                                        <div class="score-value">{{ extract_clarity_score(result.content) or 'N/A' }}</div>
                                        {% set desc = extract_clarity_description(result.content) %}
                                        {% if desc %}
                                        <div class="score-description">{{ desc }}</div>
                                        {% endif %}
                                    {% else %}
                                        <div class="error-indicator">Error</div>
                                    {% endif %}
                                </td>
                                {% endfor %}
                            </tr>

                            <!-- Visual Design Score -->
                            <tr class="data-row score-row">
                                <td class="criteria-cell">Visual Design Score</td>
                                {% for result in results %}
                                <td class="data-cell">
                                    {% if result.status == 'success' %}
                                        <div class="score-value">{{ extract_visual_design_score(result.content) or 'N/A' }}</div>
                                        {% set desc = extract_visual_design_description(result.content) %}
                                        {% if desc %}
                                        <div class="score-description">{{ desc }}</div>
                                        {% endif %}
                                    {% else %}
                                        <div class="error-indicator">Error</div>
                                    {% endif %}
                                </td>
                                {% endfor %}
                            </tr>

                            <!-- User Experience Score -->
                            <tr class="data-row score-row">
                                <td class="criteria-cell">User Experience Score</td>
                                {% for result in results %}
                                <td class="data-cell">
                                    {% if result.status == 'success' %}
                                        <div class="score-value">{{ extract_ux_score(result.content) or 'N/A' }}</div>
                                        {% set desc = extract_ux_description(result.content) %}
                                        {% if desc %}
                                        <div class="score-description">{{ desc }}</div>
                                        {% endif %}
                                    {% else %}
                                        <div class="error-indicator">Error</div>
                                    {% endif %}
                                </td>
                                {% endfor %}
                            </tr>

                            <!-- Trust & Credibility Score -->
                            <tr class="data-row score-row">
                                <td class="criteria-cell">Trust & Credibility Score</td>
                                {% for result in results %}
                                <td class="data-cell">
                                    {% if result.status == 'success' %}
                                        <div class="score-value">{{ extract_trust_score(result.content) or 'N/A' }}</div>
                                        {% set desc = extract_trust_description(result.content) %}
                                        {% if desc %}
                                        <div class="score-description">{{ desc }}</div>
                                        {% endif %}
                                    {% else %}
                                        <div class="error-indicator">Error</div>
                                    {% endif %}
                                </td>
                                {% endfor %}
                            </tr>

                            <!-- Value Communication Score -->
                            <tr class="data-row score-row">
                                <td class="criteria-cell">Value Communication Score</td>
                                {% for result in results %}
                                <td class="data-cell">
                                    {% if result.status == 'success' %}
                                        <div class="score-value">{{ extract_value_prop_score(result.content) or 'N/A' }}</div>
                                        {% set desc = extract_value_prop_description(result.content) %}
                                        {% if desc %}
                                        <div class="score-description">{{ desc }}</div>
                                        {% endif %}
                                    {% else %}
                                        <div class="error-indicator">Error</div>
                                    {% endif %}
                                </td>
                                {% endfor %}
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Analysis Complete Banner -->
            <div class="completion-banner">
                <h3>Analysis Complete!</h3>
                <p>Review your competitive analysis results above. When ready, proceed to Step 4 for optimization recommendations.</p>
                <button class="continue-btn" onclick="window.location.href='/'">
                    Continue to Step 4 ‚Üí
                </button>
            </div>

            <!-- Action Buttons -->
            <div class="action-buttons" style="margin-top: 2rem;">
                <button onclick="downloadExcel()" class="start-analysis-btn">
                    üìä Download this Data
                </button>
                <button onclick="window.location.href='/'" class="stop-analysis-btn" style="display: inline-flex;">
                    üè† Analyze More Websites
                </button>
            </div>

            <!-- Raw Data Section (Collapsible) -->
            <div class="raw-data-section" style="margin-top: 3rem;">
                <button onclick="toggleRawData()" class="add-competitor-btn" style="margin-bottom: 1rem;">
                    üìÑ Show Raw Analysis Data
                </button>
                <div id="rawDataContainer" style="display: none;">
                    {% for result in results %}
                    <div style="background: white; border-radius: 12px; padding: 1.5rem; margin-bottom: 1rem; border: 1px solid #e8eaed;">
                        <h4 style="color: #1a73e8; margin-bottom: 1rem;">{{ result.url }}</h4>
                        {% if result.status == 'success' %}
                        <pre style="background: #f8f9fa; padding: 1rem; border-radius: 6px; font-size: 12px; line-height: 1.5; overflow-x: auto;">{{ result.content }}</pre>
                        {% else %}
                        <div style="background: #fce8e6; color: #d93025; padding: 1rem; border-radius: 6px;">
                            <strong>Error:</strong> {{ result.error or 'Unknown error occurred' }}
                        </div>
                        {% endif %}
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </main>

    <script>
        function toggleRawData() {
            const container = document.getElementById('rawDataContainer');
            const button = document.querySelector('.add-competitor-btn');
            
            if (container.style.display === 'none') {
                container.style.display = 'block';
                button.innerHTML = 'üìÑ Hide Raw Analysis Data';
            } else {
                container.style.display = 'none';
                button.innerHTML = 'üìÑ Show Raw Analysis Data';
            }
        }

        function downloadExcel() {
            // Download logic here
            alert('Excel download feature - implementation needed');
        }
    </script>
</body>
</html>
